<!DOCTYPE html>
<html>
<head>
    <title>Map</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">

    <link rel="stylesheet" href="https://js.arcgis.com/4.4/esri/css/main.css">
    <script src="https://js.arcgis.com/4.4/"></script>

    <style>
    </style>

    <script>
        require([
            "esri/tasks/Locator",
            "esri/Map",
            "esri/views/MapView",
            "dojo/domReady!"
        ], function (Locator, Map, MapView) {
            // Create a locator task using the world geocoding service
            var locatorTask = new Locator({
                url: "https://geocode.arcgis.com/arcgis/rest/services/World/GeocodeServer"
            });

            // Create the Map
            var map = new Map({
                basemap: "terrain"
            });

            // Create the MapView
            var view = new MapView({
                container: "viewDiv",
                map: map,
                center: [-116.3031, 43.6088],
                zoom: 12
            });


            view.on("click", function (event) {
                event.stopPropagation();

                // Get the coordinates of the click on the view
                // around the decimals to 3 decimals
                var lat = Math.round(event.mapPoint.latitude * 1000) / 1000;
                var lon = Math.round(event.mapPoint.longitude * 1000) / 1000;

                view.popup.open({
                    // Set the popup's title to the coordinates of the clicked location
                    title: "Reverse geocode: [" + lon + ", " + lat + "]",
                    location: event.mapPoint // Set the location of the popup to the clicked location
                });
            });

            // Execute a reverse geocode using the clicked location
            locatorTask.locationToAddress(event.mapPoint).then(function (response) {
                // If an address is successfully found, show it in the popup's content
                view.popup.content = response.address;
            }).otherwise(function (err) {
                // If the promise fails and no result is found, show a generic message
                view.popup.content = "No address was found for this location";
            });
        });
    </script>
</head>
<body>
    <input type="text" disabled="disabled" id="url" size="100" />
    <input id="submitRequest" type="button" value="GO" />
    <span id="status"></span>
    <hr />
    <h2>Content</h2>
    <textarea id="content"></textarea>
</body>
</html>